<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û—Ç—á—ë—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkYAACAAAf//BA0YpZ4AAAAASUVORK5CYII=">
    <style>
        :root {
            --primary: #2563eb;
            --success: #059669;
            --warning: #d97706;
            --danger: #dc2626;
            --gray-200: #e5e7eb;
            --gray-600: #4b5563;
            --gray-800: #1f2937;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            color: #1f2937;
            line-height: 1.6;
        }

        .header {
            text-align: center;
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .score-section {
            text-align: center;
            margin: 30px 0;
        }

        .score-display {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .score-high { color: var(--success); }
        .score-medium { color: var(--warning); }
        .score-low { color: var(--danger); }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            font-size: 0.9rem;
            color: var(--gray-600);
            font-weight: 500;
            margin-bottom: 4px;
        }

        .info-value {
            font-size: 1rem;
            font-weight: 600;
        }

        .rate-limit-info {
            background: #fff7ed;
            border: 1px solid #fed7aa;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }

        .rate-limit-info .icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--gray-800);
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--gray-200);
        }

        .headers-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .headers-table th {
            background: #f8fafc;
            padding: 16px 20px;
            text-align: left;
            font-weight: 600;
            color: var(--gray-800);
            border-bottom: 2px solid var(--gray-200);
            font-size: 0.9rem;
        }

        .headers-table td {
            padding: 16px 20px;
            border-bottom: 1px solid var(--gray-200);
            vertical-align: top;
        }

        .status-present {
            color: var(--success);
            font-weight: 600;
        }

        .status-missing {
            color: var(--danger);
            font-weight: 600;
        }

        .header-value {
            font-family: 'Courier New', monospace;
            background: #f1f5f9;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
            word-break: break-word;
        }

        .risk-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .risk-high {
            background: #fef2f2;
            color: var(--danger);
            border: 1px solid #fecaca;
        }

        .risk-medium {
            background: #fffbeb;
            color: var(--warning);
            border: 1px solid #fed7aa;
        }

        .risk-low {
            background: #f0fdf4;
            color: var(--success);
            border: 1px solid #bbf7d0;
        }

        .issues-section {
            margin: 40px 0;
        }

        .issue-item {
            background: #fef2f2;
            border-left: 4px solid var(--danger);
            padding: 16px 20px;
            margin: 10px 0;
            border-radius: 0 4px 4px 0;
        }

        .issue-warning {
            background: #fffbeb;
            border-left-color: var(--warning);
        }

        .recommendations {
            background: #f0f9ff;
            border-left: 4px solid var(--primary);
            padding: 20px;
            margin: 30px 0;
            border-radius: 0 8px 8px 0;
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-200);
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        .new-scan-btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            margin-top: 20px;
            transition: background 0.2s;
        }

        .new-scan-btn:hover {
            background: #1d4ed8;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .headers-table {
                font-size: 0.9rem;
            }

            .headers-table th,
            .headers-table td {
                padding: 12px 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>üîê –û—Ç—á—ë—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</h1>
    </div>

    <!-- Rate Limit Information -->
    <div class="rate-limit-info">
        <div class="icon">‚è∞</div>
        <h3 style="margin: 0 0 8px 0; color: var(--warning);">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏–º–∏—Ç–∞—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</h3>
        <p style="margin: 0; color: var(--gray-600);">
            –î–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:<br>
            <strong>–§–æ—Ä–º–∞: 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É</strong> ‚Ä¢
            <strong>API: 5 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É</strong> ‚Ä¢
            <strong>–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º: 2 –∑–∞–ø—Ä–æ—Å–∞ –≤ –º–∏–Ω—É—Ç—É</strong>
        </p>
    </div>

    <!-- Score Section -->
    <div class="score-section">
        <div class="score-display score-medium">
            {{ security_score }}%
        </div>
        <div class="score-label">
            {% if security_score >= 80 %}
                üü¢ –û—Ç–ª–∏—á–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
            {% elif security_score >= 60 %}
                üü° –•–æ—Ä–æ—à–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
            {% else %}
                üü† –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π
            {% endif %}
        </div>
        <p>–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ {{ total_headers }} –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
    </div>

    <!-- Scan Information -->
    <div class="info-grid">
        <div class="info-item">
            <span class="info-label">üéØ –¶–µ–ª—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</span>
            <span class="info-value">{{ target }}</span>
        </div>
        <div class="info-item">
            <span class="info-label">üìÖ –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</span>
            <span class="info-value">{{ date }}</span>
        </div>
        <div class="info-item">
            <span class="info-label">‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span>
            <span class="info-value">{{ scan_duration }} —Å–µ–∫—É–Ω–¥</span>
        </div>
        <div class="info-item">
            <span class="info-label">üîç –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</span>
            <span class="info-value">{{ present_headers }}/{{ total_headers }}</span>
        </div>
    </div>

    <!-- Headers Table -->
    <h2 class="section-title">üõ°Ô∏è –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h2>

    <table class="headers-table">
        <thead>
            <tr>
                <th>–ó–∞–≥–æ–ª–æ–≤–æ–∫</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                <th>–£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞</th>
            </tr>
        </thead>
        <tbody>
            {% for header in headers %}
            <tr>
                <td style="font-weight: 600;">{{ header.name }}</td>
                <td>
                    {% if header.present %}
                    <span class="status-present">‚úÖ –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç</span>
                    {% else %}
                    <span class="status-missing">‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç</span>
                    {% endif %}
                </td>
                <td>
                    {% if header.present %}
                    <code class="header-value">{{ header.value|default('‚Äî', true)|truncate(40) }}</code>
                    {% else %}
                    <span>‚Äî</span>
                    {% endif %}
                </td>
                <td>
                    <span class="risk-badge risk-{{ header.risk|lower }}">
                        {% if header.risk == '–í—ã—Å–æ–∫–∏–π' %}
                            –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫
                        {% elif header.risk == '–°—Ä–µ–¥–Ω–∏–π' %}
                            –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫
                        {% else %}
                            –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫
                        {% endif %}
                    </span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Issues Section -->
    <div class="issues-section">
        <h2 class="section-title">üö® –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>

        {% if issues %}
            {% for issue in issues %}
            <div class="issue-item {{ 'issue-warning' if '‚ö†Ô∏è' in issue else '' }}">
                {{ issue }}
            </div>
            {% endfor %}
        {% else %}
            <div style="text-align: center; padding: 40px; color: var(--success);">
                <div style="font-size: 3rem; margin-bottom: 15px;">üéâ</div>
                <h3>–ü—Ä–æ–±–ª–µ–º –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ!</h3>
                <p>–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ</p>
            </div>
        {% endif %}
    </div>

    <!-- Recommendations -->
    <div class="recommendations">
        <h3>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</h3>
        <ul>
            <li><strong>–î–æ–±–∞–≤—å—Ç–µ Content-Security-Policy</strong> - –∑–∞—â–∏—Ç–∞ –æ—Ç XSS –∞—Ç–∞–∫</li>
            <li><strong>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Strict-Transport-Security</strong> - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTPS</li>
            <li><strong>–í–∫–ª—é—á–∏—Ç–µ X-Content-Type-Options</strong> - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ MIME-sniffing</li>
            <li><strong>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Referrer-Policy</strong> - –∫–æ–Ω—Ç—Ä–æ–ª—å —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–µ—Ä–∞</li>
            <li><strong>–î–æ–±–∞–≤—å—Ç–µ Permissions-Policy</strong> - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ API –±—Ä–∞—É–∑–µ—Ä–∞</li>
        </ul>
    </div>

    <!-- Actions -->
    <div style="text-align: center; margin: 40px 0;">
        <a href="/" class="new-scan-btn">
            üîÑ –ù–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        </a>
        <p style="color: var(--gray-600); margin-top: 10px; font-size: 0.9rem;">
            –°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Å–æ–≥–ª–∞—Å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –ª–∏–º–∏—Ç–∞–º
        </p>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>–û—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ CORS Security Scanner</p>
        <p>–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è: {{ date }}</p>
    </div>

    <script>
        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
        document.addEventListener('DOMContentLoaded', function() {
            const scanTime = new Date('{{ date }}').getTime();
            const now = new Date().getTime();
            const timeDiff = now - scanTime;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Ä–µ–º–µ–Ω–∏, –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ 2 –º–∏–Ω—É—Ç
            if (timeDiff < 120000) { // 2 –º–∏–Ω—É—Ç—ã –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
                const timeLeft = Math.ceil((120000 - timeDiff) / 1000);
                const timeInfo = document.createElement('div');
                timeInfo.style.cssText = 'text-align: center; margin: 10px 0; padding: 10px; background: #f0f9ff; border-radius: 6px;';
                timeInfo.innerHTML = `‚è≥ –°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑: <strong>${timeLeft} —Å–µ–∫—É–Ω–¥</strong>`;
                document.querySelector('.new-scan-btn').parentNode.insertBefore(timeInfo, document.querySelector('.new-scan-btn').nextSibling);
            }
        });
    </script>
</body>
</html>