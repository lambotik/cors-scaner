<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û—Ç—á—ë—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üîê</text></svg>">
    <style>
        :root {
            --primary: #2563eb;
            --success: #059669;
            --warning: #d97706;
            --danger: #dc2626;
            --gray-200: #e5e7eb;
            --gray-600: #4b5563;
            --gray-800: #1f2937;
            --cors-color: #7c3aed;
            --security-color: #dc2626;
            --privacy-color: #0891b2;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #1f2937;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .header {
            text-align: center;
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .score-section {
            text-align: center;
            margin: 30px 0;
        }

        .score-display {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .score-high { color: var(--success); }
        .score-medium { color: var(--warning); }
        .score-low { color: var(--danger); }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e5e7eb;
            border-radius: 10px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .progress-high { background: var(--success); }
        .progress-medium { background: var(--warning); }
        .progress-low { background: var(--danger); }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            font-size: 0.9rem;
            color: var(--gray-600);
            font-weight: 500;
            margin-bottom: 8px;
        }

        .info-value {
            font-size: 1rem;
            font-weight: 600;
        }

        .url-container {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid var(--primary);
        }

        .url-label {
            font-size: 0.9rem;
            color: var(--gray-600);
            font-weight: 500;
            margin-bottom: 8px;
        }

        .url-value {
            font-family: 'Courier New', monospace;
            word-break: break-all;
            font-size: 0.9rem;
            background: #f1f5f9;
            padding: 10px 12px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--gray-800);
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--gray-200);
        }

        .header-detail {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .header-name {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-status-present {
            color: var(--success);
            font-weight: 600;
        }

        .header-status-missing {
            color: var(--danger);
            font-weight: 600;
        }

        .header-property {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .header-property:before {
            content: "‚îî‚îÄ";
            position: absolute;
            left: 0;
            color: var(--gray-600);
        }

        .header-value {
            font-family: 'Courier New', monospace;
            background: #f1f5f9;
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            margin: 5px 0;
            word-break: break-word;
            font-size: 0.9rem;
        }

        .risk-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .risk-high {
            background: #fef2f2;
            color: var(--danger);
            border: 1px solid #fecaca;
        }

        .risk-medium {
            background: #fffbeb;
            color: var(--warning);
            border: 1px solid #fed7aa;
        }

        .risk-low {
            background: #f0fdf4;
            color: var(--success);
            border: 1px solid #bbf7d0;
        }

        .warning-item {
            background: #fffbeb;
            border-left: 3px solid var(--warning);
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 0 4px 4px 0;
            font-size: 0.9rem;
        }

        .recommendation-item {
            background: #f0fdf4;
            border-left: 3px solid var(--success);
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 0 4px 4px 0;
            font-size: 0.9rem;
        }

        .info-item-small {
            background: #f0f9ff;
            border-left: 3px solid var(--primary);
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 0 4px 4px 0;
            font-size: 0.9rem;
        }

        .issues-section {
            margin: 40px 0;
        }

        .issue-item {
            background: #fef2f2;
            border-left: 4px solid var(--danger);
            padding: 16px 20px;
            margin: 10px 0;
            border-radius: 0 4px 4px 0;
        }

        .issue-warning {
            background: #fffbeb;
            border-left-color: var(--warning);
        }

        .recommendations {
            background: #f0f9ff;
            border-left: 4px solid var(--primary);
            padding: 20px;
            margin: 30px 0;
            border-radius: 0 8px 8px 0;
        }

        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-200);
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        .new-scan-btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            margin-top: 20px;
            transition: background 0.2s;
        }

        .new-scan-btn:hover {
            background: #1d4ed8;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--gray-200);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray-600);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .info-grid, .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>üîê –û—Ç—á—ë—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</h1>
    </div>

    <!-- Score Section with Progress Bar -->
    <div class="score-section">
        <div class="score-display score-{% if security_score >= 80 %}high{% elif security_score >= 60 %}medium{% else %}low{% endif %}">
            {{ security_score }}%
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill progress-{% if security_score >= 80 %}high{% elif security_score >= 60 %}medium{% else %}low{% endif %}"
                 style="width: {{ security_score }}%"></div>
        </div>

        <div class="score-label">
            {% if security_score >= 80 %}
                üü¢ –û—Ç–ª–∏—á–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
            {% elif security_score >= 60 %}
                üü° –•–æ—Ä–æ—à–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
            {% else %}
                üü† –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π
            {% endif %}
        </div>
        <p>–ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ {{ total_headers }} –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
    </div>

    <!-- URL Container -->
    <div class="url-container">
        <div class="url-label">üéØ –¶–µ–ª—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</div>
        <div class="url-value">{{ target }}</div>
        <div style="margin-top: 10px; font-size: 0.9rem; color: var(--gray-600);">
            –§–∏–Ω–∞–ª—å–Ω—ã–π URL: {{ final_url }} | HTTP —Å—Ç–∞—Ç—É—Å: {{ http_status }}
        </div>
    </div>

    <!-- Statistics -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ present_headers }}/{{ total_headers }}</div>
            <div class="stat-label">üìã –ó–∞–≥–æ–ª–æ–≤–∫–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ critical_headers_present }}</div>
            <div class="stat-label">üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ issues|length }}</div>
            <div class="stat-label">‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ scan_duration }}—Å</div>
            <div class="stat-label">‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</div>
        </div>
    </div>

    <!-- Scan Information -->
    <div class="info-grid">
        <div class="info-item">
            <span class="info-label">üìÖ –î–∞—Ç–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</span>
            <span class="info-value">{{ date }}</span>
        </div>
        <div class="info-item">
            <span class="info-label">üîÑ –†–µ–¥–∏—Ä–µ–∫—Ç—ã</span>
            <span class="info-value">{% if redirected %}–î–∞{% else %}–ù–µ—Ç{% endif %}</span>
        </div>
        {% if server_info.server %}
        <div class="info-item">
            <span class="info-label">üñ•Ô∏è –°–µ—Ä–≤–µ—Ä</span>
            <span class="info-value">{{ server_info.server }}</span>
        </div>
        {% endif %}
        {% if server_info.x_powered_by %}
        <div class="info-item">
            <span class="info-label">‚ö° X-Powered-By</span>
            <span class="info-value">{{ server_info.x_powered_by }}</span>
        </div>
        {% endif %}
    </div>

    <!-- Detailed Headers Analysis -->
    <h2 class="section-title">üõ°Ô∏è –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</h2>

    {% for header in headers %}
    <div class="header-detail">
        <div class="header-name">
            {% if header.present %}
            ‚úÖ {{ header.name }}
            {% else %}
            ‚ùå {{ header.name }}
            {% endif %}
            {% if header.critical %}
            <span style="background: var(--danger); color: white; padding: 2px 6px; border-radius: 10px; font-size: 0.7rem; margin-left: 8px;">
                –ö–†–ò–¢
            </span>
            {% endif %}
        </div>

        <div class="header-property">
            <strong>–°—Ç–∞—Ç—É—Å:</strong>
            <span class="{% if header.present %}header-status-present{% else %}header-status-missing{% endif %}">
                {% if header.present %}–ü–†–ò–°–£–¢–°–¢–í–£–ï–¢{% else %}–û–¢–°–£–¢–°–¢–í–£–ï–¢{% endif %}
            </span>
        </div>

        <div class="header-property">
            <strong>–†–∏—Å–∫:</strong>
            <span class="risk-badge risk-{{ header.risk|lower }}">
                {% if header.risk == '–í—ã—Å–æ–∫–∏–π' %}
                    –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫
                {% elif header.risk == '–°—Ä–µ–¥–Ω–∏–π' %}
                    –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫
                {% else %}
                    –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫
                {% endif %}
            </span>
        </div>

        <div class="header-property">
            <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> {{ header.description }}
        </div>

        {% if header.present and header.value %}
        <div class="header-property">
            <strong>–ó–Ω–∞—á–µ–Ω–∏–µ:</strong>
            <div class="header-value">{{ header.value|truncate(100) }}</div>
        </div>
        {% endif %}

        <!-- Warnings -->
        {% if header.warnings %}
            {% for warning in header.warnings %}
            <div class="warning-item">
                {% if 'üö®' in warning or '–ö–†–ò–¢–ò–ß–ï–°–ö–û' in warning %}
                    üö® {{ warning }}
                {% elif '‚ö†Ô∏è' in warning %}
                    ‚ö†Ô∏è {{ warning }}
                {% else %}
                    ‚ÑπÔ∏è {{ warning }}
                {% endif %}
            </div>
            {% endfor %}
        {% endif %}

        <!-- Recommendations -->
        {% if header.recommendations %}
            {% for recommendation in header.recommendations %}
            <div class="recommendation-item">
                {% if '‚úÖ' in recommendation %}
                    ‚úÖ {{ recommendation }}
                {% else %}
                    üí° {{ recommendation }}
                {% endif %}
            </div>
            {% endfor %}
        {% endif %}

        <!-- Additional info for missing headers -->
        {% if not header.present %}
        <div class="info-item-small">
            üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        </div>
        {% endif %}
    </div>
    {% endfor %}

    <!-- Issues Section -->
    <div class="issues-section">
        <h2 class="section-title">üö® –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>

        {% if issues %}
            {% for issue in issues %}
            <div class="issue-item {{ 'issue-warning' if '‚ö†Ô∏è' in issue else '' }}">
                {{ issue }}
            </div>
            {% endfor %}
        {% else %}
            <div style="text-align: center; padding: 40px; color: var(--success);">
                <div style="font-size: 3rem; margin-bottom: 15px;">üéâ</div>
                <h3>–ü—Ä–æ–±–ª–µ–º –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ!</h3>
                <p>–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ</p>
            </div>
        {% endif %}
    </div>

    <!-- Final Recommendation -->
    <div class="recommendations">
        <h3>üí° –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</h3>
        {% if security_score >= 80 %}
            <p style="color: var(--success); font-weight: 600;">‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!</p>
        {% elif security_score >= 60 %}
            <p style="color: var(--warning); font-weight: 600;">‚ö†Ô∏è –•–æ—Ä–æ—à–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–æ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è.</p>
        {% else %}
            <p style="color: var(--danger); font-weight: 600;">üö® –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!</p>
        {% endif %}

        <div style="margin-top: 15px;">
            <strong>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:</strong><br>
            ‚Ä¢ –¶–µ–ª—å: {{ target }}<br>
            ‚Ä¢ –û—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: {{ security_score }}%<br>
            ‚Ä¢ –ó–∞–≥–æ–ª–æ–≤–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ: {{ total_headers }}<br>
            ‚Ä¢ –ü—Ä–æ–±–ª–µ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ: {{ issues|length }}<br>
            ‚Ä¢ –í—Ä–µ–º—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è: {{ scan_duration }} —Å–µ–∫—É–Ω–¥
        </div>
    </div>

    <!-- Actions -->
    <div style="text-align: center; margin: 40px 0;">
        <a href="/" class="new-scan-btn">
            üîÑ –ù–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
        </a>
        <p style="color: var(--gray-600); margin-top: 10px; font-size: 0.9rem;">
            –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ –¥—Ä—É–≥–∏–µ URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        </p>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>–û—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ CORS Security Scanner</p>
        <p>–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è: {{ date }}</p>
    </div>
</body>
</html>